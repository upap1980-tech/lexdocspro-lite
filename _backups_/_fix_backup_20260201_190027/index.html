<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LexDocsPro LITE v2.0</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ“š LexDocsPro LITE <span class="version">v2.0</span></h1>
            <p>Gestor de Documentos Legales con IA Multi-Proveedor</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('consulta')">ğŸ’¬ Consultas</button>
            <button class="tab-btn" onclick="switchTab('documentos')">ğŸ“ Generar Documentos</button>
            <button class="tab-btn" onclick="switchTab('lexnet')">âš–ï¸ Analizador LexNET</button>
            <button class="tab-btn" onclick="switchTab('autoprocesador')">ğŸ¤– Auto-Procesador</button>
        </div>

        <!-- TAB 1: CONSULTAS -->
        <div id="tab-consulta" class="tab-content active">
            <div class="main-layout">
                <div class="panel explorer">
                    <h2>ğŸ“ Expedientes</h2>
                    <div id="currentPath" class="path"></div>
                    <div id="fileTree" class="file-tree"></div>
                    <button onclick="refreshFiles()" class="btn-refresh">ğŸ”„ Refrescar</button>
                </div>
                <div class="panel viewer">
                    <h2>ğŸ“„ Documento</h2>
                    <div id="pdfViewer" class="pdf-container">
                        <p class="placeholder">Selecciona un PDF para visualizar</p>
                    </div>
                    <button id="btnOCR" onclick="runOCR()" class="btn-ocr" disabled>ğŸ” Ejecutar OCR</button>
                </div>
                <div class="panel chat">
                    <h2>ğŸ’¬ Asistente IA</h2>
                    <div class="ai-controls">
                        <select id="aiProvider" class="select-provider"><option value="">Cargando...</option></select>
                        <select id="aiMode" class="select-mode">
                            <option value="standard">âš¡ Consulta RÃ¡pida</option>
                            <option value="deep">ğŸ” AnÃ¡lisis Profundo</option>
                            <option value="research">ğŸ“š InvestigaciÃ³n</option>
                        </select>
                    </div>
    <!-- CONSULTAS RÃPIDAS PREDEFINIDAS -->
    <div class="consultas-rapidas" style="margin: 15px 0; padding: 10px; background: #f8f9fa; border-radius: 8px;">
        <h3 style="font-size: 14px; margin-bottom: 8px; color: #555;">âš¡ Consultas RÃ¡pidas:</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">
            <button onclick="cargarConsulta('Explica los elementos del delito de estafa segÃºn el CÃ³digo Penal espaÃ±ol')" class="btn-consulta-rapida" title="AnÃ¡lisis completo del delito de estafa">ğŸ“‹ Elementos delito estafa</button>
            <button onclick="cargarConsulta('Â¿CuÃ¡les son los plazos para recurrir una sentencia civil en EspaÃ±a?')" class="btn-consulta-rapida" title="Plazos de recurso civil">â° Plazos procesales</button>
            <button onclick="cargarConsulta('Â¿QuÃ© requisitos formales debe cumplir una demanda civil segÃºn la LEC?')" class="btn-consulta-rapida" title="Requisitos formales de demanda">ğŸ“„ Requisitos demanda</button>
            <button onclick="cargarConsulta('Analiza este auto judicial y extrae: tipo, fecha, tribunal, partes y decisiÃ³n')" class="btn-consulta-rapida" title="AnÃ¡lisis automÃ¡tico de auto LexNET">ğŸ” AnÃ¡lisis Auto LexNET</button>
        </div>
    </div>
                    <div id="chatMessages" class="chat-messages"></div>
                    <div class="chat-input">
                        <textarea id="chatPrompt" placeholder="Escribe tu consulta legal..." rows="3"></textarea>
                        <button onclick="sendMessage()" class="btn-send">Enviar</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: GENERADOR DE DOCUMENTOS -->
        <div id="tab-documentos" class="tab-content">
            <div class="doc-generator">
                <div class="doc-sidebar">
                    <h2>ğŸ“‹ Tipo de Documento</h2>
                    <div id="docTypes" class="doc-types"></div>
                </div>
                <div class="doc-form">
                    <h2 id="docFormTitle">Selecciona un tipo de documento</h2>
                    <p id="docFormDesc" class="doc-description"></p>
                    <form id="documentForm" class="hidden">
                        <div id="formFields"></div>
                        <div class="form-actions">
                            <select id="docProvider" class="select-provider"><option value="ollama">Ollama</option></select>
                            <button type="button" onclick="generateDocument()" class="btn-generate">âœ¨ Generar Documento</button>
                        </div>
                    </form>
                    <div id="generatedDoc" class="generated-doc hidden">
                        <h3>ğŸ“„ Documento Generado</h3>
                        <div class="doc-actions">
                            <button onclick="copyDocument()" class="btn-copy">ğŸ“‹ Copiar</button>
                            <button onclick="downloadDocument()" class="btn-download">ğŸ’¾ Descargar</button>
                            <button onclick="resetGenerator()" class="btn-reset">ğŸ”„ Nuevo</button>
                        </div>
                        <pre id="docContent" class="doc-content"></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 3: ANALIZADOR LEXNET -->
        <div id="tab-lexnet" class="tab-content">
            <div class="lexnet-analyzer">
                <div class="lexnet-upload">
                    <h2>ğŸ“¤ Subir Documentos</h2>
                    <p class="lexnet-instructions">
                        Sube uno o mÃ¡s archivos PDF/imÃ¡genes. MÃ­nimo 1 archivo requerido.
                    </p>
                    
                    <div class="upload-zone-simple" onclick="document.getElementById('filesMultiple').click()">
                        <div class="upload-icon-big">ğŸ“</div>
                        <p class="upload-prompt"><strong>Haz clic para seleccionar archivos</strong></p>
                        <p class="upload-hint">PDF, JPG, PNG, DOCX... | Uno o varios archivos</p>
                        <input type="file" id="filesMultiple" multiple accept="*/*" onchange="handleMultipleFilesLexNet()" style="display: none;">
                    </div>
                    
                    <div class="files-list-simple" id="filesListLexNet"></div>
                    
                    <div class="lexnet-controls">
                        <select id="lexnetProvider" class="select-provider"><option value="ollama">ğŸ  Ollama</option></select>
                        <button onclick="analyzeLexNetMultiple()" class="btn-analyze" id="btnAnalyzeLexNet" disabled>
                            ğŸ” Analizar NotificaciÃ³n
                        </button>
                    </div>
                </div>
                
                <div class="lexnet-result">
                    <h2>ğŸ“Š AnÃ¡lisis LexNET</h2>
                    <div id="lexnetContent" class="lexnet-content">
                        <p class="placeholder">Sube al menos 1 documento y presiona "Analizar NotificaciÃ³n"</p>
                    </div>
                    <div class="lexnet-actions hidden" id="lexnetActions">
                        <button onclick="copyLexNetAnalysis()" class="btn-copy">ğŸ“‹ Copiar</button>
                        <button onclick="downloadLexNetAnalysis()" class="btn-download">ğŸ’¾ Descargar TXT</button>
                        <button onclick="resetLexNetMultiple()" class="btn-reset">ğŸ”„ Nuevo</button>
                    </div>
                </div>
            </div>
        
        <!-- TAB 4: AUTO-PROCESADOR -->
        <div id="tab-autoprocesador" class="tab-content">
            <div class="autoprocesador-layout">
                <!-- Panel Izquierdo: Dashboard con estadÃ­sticas -->
                <div class="panel autoprocesador-stats">
                    <h2>ğŸ“Š Dashboard Auto-Procesador</h2>
                    
                    <div class="stats-cards">
                        <div class="stat-card stat-total">
                            <div class="stat-icon">ğŸ“</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stat-total">0</div>
                                <div class="stat-label">Total Hoy</div>
                            </div>
                        </div>
                        
                        <div class="stat-card stat-auto">
                            <div class="stat-icon">âœ…</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stat-auto">0</div>
                                <div class="stat-label">AutomÃ¡ticos</div>
                                <div class="stat-percent" id="percent-auto">0%</div>
                            </div>
                        </div>
                        
                        <div class="stat-card stat-revision">
                            <div class="stat-icon">âš ï¸</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stat-revision">0</div>
                                <div class="stat-label">En RevisiÃ³n</div>
                                <div class="stat-percent" id="percent-revision">0%</div>
                            </div>
                        </div>
                        
                        <div class="stat-card stat-error">
                            <div class="stat-icon">âŒ</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stat-error">0</div>
                                <div class="stat-label">Errores</div>
                                <div class="stat-percent" id="percent-error">0%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-actions">
                        <button onclick="refreshAutoProcesadorStats()" class="btn-refresh">ğŸ”„ Actualizar</button>
                        <button onclick="showAllProcessed()" class="btn-secondary">ğŸ“‹ Ver Todos</button>
                    </div>
                    
                    <h3 style="margin-top: 20px;">â³ Cola de RevisiÃ³n</h3>
                    <div id="documentsList" class="documents-list">
                        <p class="placeholder">Cargando documentos...</p>
                    </div>
                </div>
                
                <!-- Panel Central: Visor de Documento -->
                <div class="panel autoprocesador-viewer">
                    <h2>ğŸ‘ï¸ Vista Previa</h2>
                    <div id="autoProcesadorPdfViewer" class="pdf-container">
                        <p class="placeholder">Selecciona un documento de la lista para ver detalles</p>
                    </div>
                </div>
                
                <!-- Panel Derecho: Detalles y Acciones -->
                <div class="panel autoprocesador-actions">
                    <h2>ğŸ“ Detalles del Documento</h2>
                    
                    <div id="documentDetails" class="document-details hidden">
                        <div class="detail-group">
                            <label>ğŸ“„ Archivo:</label>
                            <input type="text" id="detail-filename" readonly class="detail-input">
                        </div>
                        
                        <div class="detail-group">
                            <label>ğŸ‘¤ Cliente:</label>
                            <input type="text" id="detail-cliente" class="detail-input editable">
                            <select id="detail-cliente-select" class="detail-select">
                                <option value="">-- Seleccionar cliente --</option>
                            </select>
                        </div>
                        
                        <div class="detail-group">
                            <label>ğŸ“‹ Tipo Documento:</label>
                            <select id="detail-tipo" class="detail-select editable">
                                <option value="Contrato">Contrato</option>
                                <option value="Factura">Factura</option>
                                <option value="Escritura">Escritura</option>
                                <option value="Sentencia">Sentencia</option>
                                <option value="Demanda">Demanda</option>
                                <option value="Otros">Otros</option>
                            </select>
                        </div>
                        
                        <div class="detail-group">
                            <label>ğŸ“… Fecha Documento:</label>
                            <input type="text" id="detail-fecha" readonly class="detail-input">
                        </div>
                        
                        <div class="detail-group">
                            <label>ğŸ“ Carpeta Sugerida:</label>
                            <input type="text" id="detail-carpeta" readonly class="detail-input">
                        </div>
                        
                        <div class="detail-group">
                            <label>ğŸ¯ Confianza:</label>
                            <div class="confidence-bar">
                                <div id="detail-confianza-bar" class="confidence-fill" style="width: 0%"></div>
                                <span id="detail-confianza-text" class="confidence-text">0%</span>
                            </div>
                        </div>
                        
                        <div class="alert-info" style="margin: 15px 0;">
                            <strong>ğŸ’¡ Nota:</strong> Puedes modificar el cliente y tipo antes de aprobar.
                        </div>
                        
                        <div class="action-buttons">
                            <button onclick="aprobarDocumento()" class="btn-approve">
                                âœ… Aprobar y Guardar
                            </button>
                            <button onclick="rechazarDocumento()" class="btn-reject">
                                âŒ Rechazar
                            </button>
                        </div>
                    </div>
                    
                    <div id="noDocumentSelected" class="no-selection">
                        <div class="no-selection-icon">ğŸ“„</div>
                        <p>Selecciona un documento de la lista para ver sus detalles y tomar acciÃ³n</p>
                    </div>
                </div>
            </div>
        </div>


        <footer><span id="status">Listo</span></footer>
    </div>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
